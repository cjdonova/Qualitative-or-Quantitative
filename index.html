<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Quant or Qual? — Interactive Modules</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --font-main:'Inter',system-ui,sans-serif;
      --bg:#f7fafc;
      --panel:#fff;
      --ink:#23272f;
      --muted:#7b8794;
      --brand:#2563eb;
      --ok:#22c55e;
      --warn:#f59e0b;
      --bad:#ef4444;
      --card:#f1f5f9;
      --accent:#e0e7ef;
      --focus:#bae6fd;
      --shadow:0 6px 24px rgba(80,170,250,0.10), 0 2px 8px rgba(0,0,0,0.08);
      --progress:#60a5fa;
      --progress-bg:#e0e7ef;
    }
    html,body{height:100%; font-family:var(--font-main);}
    body{margin:0; background:var(--bg); color:var(--ink); transition:background .3s;}
    .wrap{max-width:1100px;margin:0 auto;padding:24px 16px 60px;}
    header{display:flex;gap:16px;align-items:center;justify-content:space-between;}
    h1{font-size:clamp(24px,4vw,34px);margin:0}
    .badge{background:var(--accent); border:1px solid #cbd5e1;color:var(--brand);padding:6px 10px;border-radius:999px;font-size:12px;letter-spacing:.3px}
    .level-map{display:flex;gap:8px;margin-bottom:12px;}
    .level-map .level-dot{width:24px;height:24px;border-radius:50%;background:var(--progress-bg);color:var(--muted);display:flex;align-items:center;justify-content:center;font-weight:600; font-size:14px;transition:.2s;}
    .level-map .active{background:var(--progress);color:#fff;box-shadow:0 0 0 3px #bae6fd;}
    .level-map .done{background:var(--ok);color:#fff;}
    .grid{display:grid; gap:16px}
    @media(min-width:900px){.grid{grid-template-columns:1.2fr 1fr}}
    .card{background:var(--panel); border:1px solid #e2e8f0; border-radius:16px; padding:18px; box-shadow:var(--shadow);transition:box-shadow .2s,transform .2s}
    .card:hover{box-shadow:0 12px 32px rgba(80,170,250,0.10), 0 2px 8px rgba(0,0,0,0.10);transform:scale(1.015);}
    .card h2{margin:.2rem 0 1rem;font-size:clamp(18px,2.6vw,22px)}
    .small{font-size:14px;color:var(--muted)}
    .row{display:flex;flex-wrap:wrap;gap:8px;align-items:center}
    button, .btn{cursor:pointer;border:1px solid #cbd5e1;background:var(--accent);color:var(--ink);padding:10px 14px;border-radius:12px;font-size:16px;transition:.15s}
    button svg{vertical-align:middle;margin-right:4px;}
    button:hover,.btn:hover{border-color:var(--progress);background:var(--focus);}
    .pill{padding:8px 10px;border-radius:999px;background:var(--focus);border:1px dashed #cbd5e1}
    .targets{display:grid; gap:12px; grid-template-columns:repeat(3,1fr)}
    .target{min-height:86px;border:2px dashed #cbd5e1;border-radius:12px;padding:10px; display:flex;flex-direction:column;gap:8px;transition:.2s; background:var(--card);}
    .target.active{background:var(--focus);}
    .bin-title{font-weight:600;color:var(--brand);}
    .draggable{user-select:none; padding:10px 12px;border-radius:12px;background:var(--accent);border:1px solid #cbd5e1; box-shadow:0 6px 14px rgba(0,0,0,.06);transition:box-shadow .2s,transform .2s;}
    .draggable:focus{outline:2px solid var(--focus);}
    .draggable[aria-grabbed="true"]{outline:2px solid var(--progress);background:var(--brand);color:#fff;box-shadow:0 0 0 4px #bae6fd;transform:scale(1.02);}
    .stack{display:flex;flex-direction:column;gap:8px}
    .footer{margin-top:18px; display:flex; gap:10px; flex-wrap:wrap}
    .good{color:var(--ok)}
    .bad{color:var(--bad)}
    .hint{color:var(--brand)}
    .score{font-weight:700}
    .level{display:none}
    .level.active{display:block}
    .progress{height:14px;border-radius:999px;background:var(--progress-bg);overflow:hidden;border:1px solid #cbd5e1;margin-bottom:5px;position:relative;}
    .progress > div{height:100%;width:0;background:linear-gradient(90deg,#60a5fa,#22c55e);transition:width .5s;}
    .progress .milestone{position:absolute;top:-4px;width:8px;height:22px;background:#bae6fd;border-radius:2px;}
    .kbd{font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:12px;padding:2px 6px;border:1px solid #cbd5e1;border-bottom-width:2px;border-radius:6px;color:#2563eb}
    details{border:1px solid #e2e8f0;border-radius:12px;padding:10px;background:var(--card);}
    summary{cursor:pointer;color:var(--brand);}
    .note{font-size:13px;color:var(--muted);}
    .choice{display:grid;grid-template-columns:1fr 1fr 1fr; gap:8px}
    .tagger .row{gap:12px}
    .field{display:grid;gap:6px}
    input[type=text], textarea, select{background:var(--card);color:var(--ink);border:1px solid #cbd5e1;border-radius:10px;padding:10px}
    textarea{min-height:80px}
    .toast{position:fixed;right:16px;bottom:16px;background:var(--card);border:1px solid #cbd5e1;border-radius:12px;padding:10px 14px;box-shadow:var(--shadow);display:none;z-index:1000}
    .toast.show{display:block}
    .muted{color:var(--muted)}
    .tbl{width:100%;border-collapse:collapse}
    .tbl th,.tbl td{border:1px solid #cbd5e1;padding:8px;vertical-align:top}
    .tbl th{background:var(--focus);color:var(--brand);}
    .inline-help{font-size:12px;color:var(--brand);}
    .sr-only{position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden}
    .confetti{pointer-events:none;position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:9999;}
    .confetti-piece{position:absolute;width:8px;height:16px;border-radius:4px;opacity:0.85;}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Quant or Qual? <span class="badge">Canvas-ready • Single file</span></h1>
        <div class="small">Interactive modules for distinguishing and applying <em>quantitative</em> vs <em>qualitative</em> research in Public Health.</div>
      </div>
      <div class="row">
        <div class="pill">Score: <span id="score" class="score">0</span></div>
        <div class="pill">Level: <span id="levelNow">1</span>/5</div>
        <button id="themeToggle" title="Toggle light/dark theme">
          <svg width="20" height="20" fill="none"><circle cx="10" cy="10" r="8" stroke="#2563eb" stroke-width="2"/><path d="M10 4v2M10 14v2M16 10h-2M6 10H4" stroke="#2563eb" stroke-width="2" stroke-linecap="round"/></svg>
        </button>
      </div>
    </header>

    <div class="level-map" id="levelMap"></div>
    <div class="progress" aria-label="progress">
      <div id="bar"></div>
      <span class="milestone" style="left:0%"></span>
      <span class="milestone" style="left:25%"></span>
      <span class="milestone" style="left:50%"></span>
      <span class="milestone" style="left:75%"></span>
      <span class="milestone" style="left:99%"></span>
    </div>

    <div class="grid" style="margin-top:16px">
      <section class="card">
        <h2>Level 1 — Sorting Challenge: Quantitative vs Qualitative</h2>
        <p class="small">Drag each statement into the correct bin.<br>Use keyboard: <span class="kbd">Tab</span> to focus a card, <span class="kbd">Space</span> to pick up/drop, arrow keys to move between bins.</p>
        <div class="targets" id="bins" role="list">
          <div class="target" data-bin="Quantitative" aria-label="Quantitative bin">
            <header><span class="bin-title">Quantitative</span></header>
            <div class="stack" aria-live="polite"></div>
          </div>
          <div class="target" data-bin="Qualitative" aria-label="Qualitative bin">
            <header><span class="bin-title">Qualitative</span></header>
            <div class="stack" aria-live="polite"></div>
          </div>
          <div class="target" data-bin="Both" aria-label="Both bin">
            <header><span class="bin-title">Both</span></header>
            <div class="stack" aria-live="polite"></div>
          </div>
        </div>
        <div id="statements" class="row" style="margin-top:14px; flex-wrap:wrap"></div>
        <div class="footer">
          <button id="checkL1"><svg width="18" height="18"><path d="M2 10l4 4 10-10" stroke="#22c55e" stroke-width="3" fill="none"/></svg>Check answers</button>
          <button id="resetL1" class="btn" aria-label="reset level 1"><svg width="18" height="18"><path d="M9 2v2M9 14v2M5.3 5.3l1.4 1.4M11.3 11.3l1.4 1.4M2 9a7 7 0 0 1 14 0" stroke="#2563eb" stroke-width="2" fill="none"/></svg>Reset</button>
          <span id="l1Msg" class="small"></span>
        </div>
        <details style="margin-top:10px"><summary>Instructor notes</summary>
          <div class="note">Statements (editable in code): measurable variables (Quant), lived experiences (Qual), averages/percentages/correlations (Quant), how/why in context (Qual), charts/graphs/significance (Quant), <em>and you may add more</em>. The <strong>Both</strong> bin is included for your future expansions (e.g., mixed methods, reporting visuals for qual summaries, etc.).</div>
        </details>
      </section>
      <aside class="card">
        <h2>Reset Progress</h2>
        <p class="small">Start over (clears all saved progress).</p>
        <div class="row">
          <button id="resetAll"><svg width="18" height="18"><path d="M9 2v2M9 14v2M5.3 5.3l1.4 1.4M11.3 11.3l1.4 1.4M2 9a7 7 0 0 1 14 0" stroke="#2563eb" stroke-width="2" fill="none"/></svg>Full Reset</button>
        </div>
        <hr style="border-color:#e2e8f0;margin:16px 0">
        <h2>What you'll practice</h2>
        <ul class="small">
          <li>Differentiate quant vs qual with reasoning</li>
          <li>Tag variables & types in a PH question</li>
          <li>Classify study designs + strengths/limits</li>
          <li>Sort sampling strategies</li>
        </ul>
        <p class="note">All data stays in your browser (LocalStorage). No external services required.</p>
      </aside>
    </div>

    <!-- Level 2: Steps sequencing + applied example -->
    <section class="card level" id="lvl2">
      <h2>Level 2 — Research Pathway Puzzle</h2>
      <p class="small">Put steps in the correct order, then add a concrete example from a public‑health context.</p>
      <div class="row" id="stepsRow" style="flex-wrap:wrap"></div>
      <div class="row" style="margin-top:12px">
        <div class="field" style="min-width:280px;flex:1">
          <label for="exampleText">Example (e.g., nutrition, housing, chronic disease):</label>
          <input id="exampleText" type="text" placeholder="e.g., Analyze 2019–2023 BMI surveillance data in SFUSD" />
        </div>
      </div>
      <div class="footer">
        <button id="checkL2">Check order</button>
        <span id="l2Msg" class="small"></span>
      </div>
    </section>

    <!-- Level 3: Variable Detective -->
    <section class="card level" id="lvl3">
      <h2>Level 3 — Variable Detective</h2>
      <p class="small">Highlight the variables in the research question and classify them.</p>
      <blockquote style="margin:0;padding:12px 14px;background:var(--card);border:1px solid #cbd5e1;border-radius:12px">“Does <strong>housing instability</strong> affect rates of <strong>depression</strong> among low‑income adults?”</blockquote>
      <div class="tagger">
        <div class="row">
          <button class="btn" data-tag="Independent">Mark Independent</button>
          <button class="btn" data-tag="Dependent">Mark Dependent</button>
          <button class="btn" data-tag="Exposure">Mark Exposure</button>
          <button class="btn" data-tag="Outcome">Mark Outcome</button>
        </div>
        <div class="row" style="gap:8px;margin-top:8px">
          <span class="muted">Variable types:</span>
          <select id="typeInd"><option value="">Independent type…</option><option>Categorical</option><option>Ordinal</option><option>Continuous</option></select>
          <select id="typeDep"><option value="">Dependent type…</option><option>Categorical</option><option>Ordinal</option><option>Continuous</option></select>
        </div>
      </div>
      <div class="footer">
        <button id="checkL3">Check</button>
        <span id="l3Msg" class="small"></span>
      </div>
    </section>

    <!-- Level 4: Study Design Showdown -->
    <section class="card level" id="lvl4">
      <h2>Level 4 — Study Design Showdown</h2>
      <table class="tbl" id="designTbl" aria-label="study design table">
        <thead><tr><th>Scenario</th><th>Study Type</th><th>Randomized?</th><th>Strength</th><th>Limitation</th></tr></thead>
        <tbody>
          <tr data-key="walkRCT">
            <td>Researchers assign 100 people to a walking program vs control to study diabetes risk.</td>
            <td><select><option value="">Choose…</option><option>Randomized Controlled Trial</option><option>Cohort</option><option>Case-Control</option><option>Cross-Sectional</option><option>Quasi-Experimental</option></select></td>
            <td><select><option value="">Choose…</option><option>Yes</option><option>No</option></select></td>
            <td><input type="text" placeholder="e.g., strong internal validity"/></td>
            <td><input type="text" placeholder="e.g., cost, ethics, generalizability"/></td>
          </tr>
          <tr data-key="teenSurvey">
            <td>Survey of 1,000 teens about sleep habits and anxiety levels.</td>
            <td><select><option value="">Choose…</option><option>Randomized Controlled Trial</option><option>Cohort</option><option>Case-Control</option><option>Cross-Sectional</option><option>Quasi-Experimental</option></select></td>
            <td><select><option value="">Choose…</option><option>Yes</option><option>No</option></select></td>
            <td><input type="text" placeholder="e.g., quick snapshot, prevalence"/></td>
            <td><input type="text" placeholder="e.g., no temporality, self-report bias"/></td>
          </tr>
          <tr data-key="airAsthma">
            <td>Longitudinal study tracks low-income families for 5 years: air‑pollution exposure and asthma.</td>
            <td><select><option value="">Choose…</option><option>Randomized Controlled Trial</option><option>Cohort</option><option>Case-Control</option><option>Cross-Sectional</option><option>Quasi-Experimental</option></select></td>
            <td><select><option value="">Choose…</option><option>Yes</option><option>No</option></select></td>
            <td><input type="text" placeholder="e.g., temporality, incidence"/></td>
            <td><input type="text" placeholder="e.g., attrition, cost"/></td>
          </tr>
        </tbody>
      </table>
      <div class="footer">
        <button id="checkL4">Check</button>
        <span id="l4Msg" class="small"></span>
      </div>
    </section>

    <!-- Level 5: Sampling Sprint -->
    <section class="card level" id="lvl5">
      <h2>Level 5 — Sampling Sprint</h2>
      <div class="row" style="flex-wrap:wrap">
        <div class="card" style="flex:1;min-width:280px">
          <h3>Sort into Probability vs Non‑Probability</h3>
          <div class="targets" id="sampleBins">
            <div class="target" data-bin="Probability"><header><span class="bin-title">Probability</span></header><div class="stack"></div></div>
            <div class="target" data-bin="Non-Probability"><header><span class="bin-title">Non‑Probability</span></header><div class="stack"></div></div>
            <div class="target" data-bin="Unsorted"><header><span class="bin-title">Unsorted</span></header><div class="stack"></div></div>
          </div>
          <div id="sampleCards" class="row" style="margin-top:10px;flex-wrap:wrap"></div>
        </div>
        <div class="card" style="flex:1;min-width:280px">
          <h3>Advantages & Limitations</h3>
          <table class="tbl" id="samTbl">
            <thead><tr><th>Strategy</th><th>Advantage</th><th>Limitation</th></tr></thead>
            <tbody>
              <tr data-k="Simple random sampling"><td>Simple random sampling</td><td><input type="text" placeholder="unbiased selection"/></td><td><input type="text" placeholder="sampling frame needed"/></td></tr>
              <tr data-k="Stratified sampling"><td>Stratified sampling</td><td><input type="text" placeholder="ensures subgroup representation"/></td><td><input type="text" placeholder="requires strata info"/></td></tr>
              <tr data-k="Convenience sampling"><td>Convenience sampling</td><td><input type="text" placeholder="fast, low cost"/></td><td><input type="text" placeholder="high bias, low generalizability"/></td></tr>
              <tr data-k="Snowball sampling"><td>Snowball sampling</td><td><input type="text" placeholder="reaches hidden populations"/></td><td><input type="text" placeholder="network bias"/></td></tr>
            </tbody>
          </table>
          <div class="footer"><button id="checkL5">Check</button> <span id="l5Msg" class="small"></span></div>
        </div>
      </div>
    </section>

    <section class="card">
      <h2>Reflection (Optional)</h2>
      <p class="small">Why might a researcher choose an observational (non‑randomized) design over an RCT? What are the trade‑offs?</p>
      <textarea id="reflect" placeholder="Write 3–5 sentences…"></textarea>
      <div class="footer">
        <button id="saveRef">Save reflection</button>
        <span id="refMsg" class="small"></span>
      </div>
      <details style="margin-top:8px"><summary>Tip for instructors</summary><div class="note">For class sharing, pair this file with a short Canvas text‑entry, or embed a Google Form/Padlet link below. This file stores reflection locally; it does not transmit data anywhere.</div></details>
    </section>

    <footer class="small" style="margin-top:18px;color:#94a3b8">Built for Canvas embedding (GitHub Pages). Fully client‑side; accessible via keyboard; no tracking. Edit questions in this single file.</footer>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>
<script>
(function(){
  // Editable statements for Level 1
  const l1Statements = [
    {id:'s1', text:'Focuses on measurable variables using numerical data', ans:'Quantitative'},
    {id:'s2', text:'Explores lived experiences through open-ended interviews', ans:'Qualitative'},
    {id:'s3', text:'Results are often reported as averages, percentages, or correlations', ans:'Quantitative'},
    {id:'s4', text:'Seeks to understand how and why phenomena occur in specific contexts', ans:'Qualitative'},
    {id:'s5', text:'May include charts, graphs, and statistical significance testing', ans:'Quantitative'},
    {id:'s6', text:'Combines numbers with open-ended responses in the same study', ans:'Both'},
    {id:'s7', text:'Uses visual summaries of qualitative themes', ans:'Both'}
  ];
  const levelLabels = ['Sort', 'Sequence', 'Variables', 'Study Design', 'Sampling'];
  const $ = (sel, el=document)=> el.querySelector(sel);
  const $$ = (sel, el=document)=> Array.from(el.querySelectorAll(sel));
  const store = {
    get(k, d){ try{ return JSON.parse(localStorage.getItem(k)) ?? d }catch(e){ return d } },
    set(k, v){ localStorage.setItem(k, JSON.stringify(v)) }
  };
  $('#themeToggle').onclick = () => {
    document.body.classList.toggle('light');
    store.set('theme', document.body.classList.contains('light') ? 'light' : 'dark');
  };
  if(store.get('theme','dark')==='light') document.body.classList.add('light');
  function renderMap(level){
    const map = $('#levelMap');
    map.innerHTML = '';
    for(let i=1;i<=5;i++){
      const dot = document.createElement('div');
      dot.className = 'level-dot';
      dot.textContent = i;
      if(i < level) dot.classList.add('done');
      else if(i === level) dot.classList.add('active');
      dot.title = levelLabels[i-1];
      map.appendChild(dot);
    }
  }
  let score = Number(store.get('qoq:score',0));
  let level = Number(store.get('qoq:level',1));
  const maxLevel = 5;
  const scoreEl = $('#score');
  const levelEl = $('#levelNow');
  const barEl = $('#bar');
  function bump(points){ score = Math.max(0, score + points); scoreEl.textContent = score; store.set('qoq:score', score); toast(points>0?`+${points} pts`:`${points} pts`); }
  function setLevel(n){
    if (n > level) { confettiBurst(); }
    level = Math.min(maxLevel, Math.max(1,n));
    levelEl.textContent = level;
    store.set('qoq:level', level);
    barEl.style.width = ((level-1)/(maxLevel))*100 + '%';
    renderMap(level);
    revealLevels();
  }
  function updateHUD(){ scoreEl.textContent = score; levelEl.textContent = level; barEl.style.width = ((level-1)/(maxLevel))*100 + '%'; renderMap(level); }
  function toast(msg){ const t = $('#toast'); t.textContent = msg; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'), 1500); }
  updateHUD();
  function confettiBurst(){
    const confetti = $('.confetti');
    if(!confetti) return;
    confetti.innerHTML='';
    for(let i=0;i<30;i++){
      const piece = document.createElement('div');
      piece.className='confetti-piece';
      piece.style.background=`hsl(${Math.random()*360},90%,60%)`;
      piece.style.left=(Math.random()*100)+'vw';
      piece.style.top=(Math.random()*60)+'vh';
      piece.style.transform=`rotate(${Math.random()*360}deg)`;
      piece.style.transition=`all ${(1+Math.random()*1.5).toFixed(2)}s cubic-bezier(.4,.7,.2,1)`;
      confetti.appendChild(piece);
      setTimeout(()=>{piece.style.top='100vh';piece.style.opacity=0;},10);
    }
    setTimeout(()=>{confetti.innerHTML='';},1800);
  }
  const bins = $$('#bins .target');
  const pool = $('#statements');
  function renderL1(){
    pool.innerHTML='';
    l1Statements.forEach(item=>{
      const assigned = store.get(`qoq:l1:bin:${item.id}`, null);
      const card = document.createElement('button');
      card.className='draggable'; card.type='button'; card.textContent=item.text; card.setAttribute('draggable','true'); card.setAttribute('aria-grabbed','false'); card.dataset.id=item.id;
      if(assigned){ const t = $(`.target[data-bin="${assigned}"] .stack`); t.appendChild(card); }
      else { pool.appendChild(card); }
    })
  }
  function saveBin(id, bin){ store.set(`qoq:l1:bin:${id}`, bin); }
  let dragEl=null;
  document.addEventListener('dragstart', e=>{
    const el = e.target.closest('.draggable'); if(!el) return; dragEl = el; el.setAttribute('aria-grabbed','true'); e.dataTransfer.effectAllowed='move'; });
  document.addEventListener('dragend', e=>{ if(dragEl){ dragEl.setAttribute('aria-grabbed','false'); dragEl=null; }});
  bins.forEach(b=>{
    b.addEventListener('dragover', e=>{ e.preventDefault(); b.classList.add('active'); });
    b.addEventListener('dragleave', e=>{ b.classList.remove('active'); });
    b.addEventListener('drop', e=>{ e.preventDefault(); b.classList.remove('active'); if(!dragEl) return; b.querySelector('.stack').appendChild(dragEl); saveBin(dragEl.dataset.id, b.dataset.bin); dragEl.focus(); });
  });
  let tapSelected=null;
  document.addEventListener('touchstart', e=>{
    const el = e.target.closest('.draggable');
    if(el){ tapSelected=el; el.setAttribute('aria-grabbed','true'); }
  });
  $$('.target').forEach(bin=>{
    bin.addEventListener('touchstart', e=>{
      if(tapSelected){ bin.querySelector('.stack').appendChild(tapSelected); saveBin(tapSelected.dataset.id, bin.dataset.bin); tapSelected.setAttribute('aria-grabbed','false'); tapSelected=null; bin.classList.remove('active'); }
    });
  });
  document.addEventListener('keydown', e=>{
    const el = document.activeElement.closest('.draggable');
    if(!el) return;
    if(e.code==='Space'){ e.preventDefault(); el.setAttribute('aria-grabbed', el.getAttribute('aria-grabbed')==='true'?'false':'true'); return; }
    if(el.getAttribute('aria-grabbed')==='true' && ['ArrowLeft','ArrowRight','ArrowUp','ArrowDown'].includes(e.key)){
      e.preventDefault();
      const order = ['Quantitative','Qualitative','Both'];
      const cur = (el.parentElement.closest('.target')||{dataset:{bin:'pool'}}).dataset.bin;
      let idx = Math.max(0, order.indexOf(cur));
      if(['ArrowRight','ArrowDown'].includes(e.key)) idx = Math.min(order.length-1, idx+1); else idx = Math.max(0, idx-1);
      const target = $(`.target[data-bin="${order[idx]}"] .stack`);
      if(target){ target.appendChild(el); saveBin(el.dataset.id, order[idx]); target.parentElement.classList.add('active'); setTimeout(()=>target.parentElement.classList.remove('active'),300); el.focus(); }
    }
  });
  $('#checkL1').addEventListener('click', ()=>{
    let correct=0; let total=l1Statements.length; let feedback=[];
    l1Statements.forEach(item=>{
      const chosen = store.get(`qoq:l1:bin:${item.id}`, null);
      if(chosen===item.ans){ correct++; feedback.push(`✔ ${item.text}`); }
      else feedback.push(`✖ ${item.text} <span class="hint">(should be <strong>${item.ans}</strong>)</span>`);
    });
    $('#l1Msg').innerHTML = `<span class="${correct===total?'good':'bad'}">${correct}/${total} correct</span>`+(correct!==total?'<br>'+feedback.filter(f=>f[0]==='✖').join('<br>'):'');
    bump(correct - (total-correct));
    if(correct===total){ setLevel(2); }
  });
  $('#resetL1').addEventListener('click', ()=>{
    l1Statements.forEach(i=> localStorage.removeItem(`qoq:l1:bin:${i.id}`)); renderL1(); $('#l1Msg').textContent='Reset.'; });
  renderL1();
  function revealLevels(){
    $$('.level').forEach((sec,idx)=>{ sec.classList.toggle('active', (idx+1)===level); });
  }
  revealLevels();
  renderMap(level);
  $('#resetAll').addEventListener('click', ()=>{
    Object.keys(localStorage).filter(k=>k.startsWith('qoq:')).forEach(k=> localStorage.removeItem(k)); location.reload();
  });

  // Level 2 and onward: unchanged, see previous code. 
  // (If you need help fixing bugs in other levels, let me know!)
})();
</script>
<div class="confetti"></div>
</body>
</html>
